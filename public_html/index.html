<html>    
    <head>
        <title>Pandemic!</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
        <link rel="stylesheet"  type="text/css" href="layoutCSS.css">
        <script src="jquery-3.2.1.min.js"></script>
        <script language="JavaScript">
            
            var circles = [];
            
            function updateBoard(){
                
                var canvas = document.getElementById('myCanvas');
                var context = canvas.getContext('2d');
                var rect = canvas.getBoundingClientRect();
                
                canvas.addEventListener('click', function(e){
                
                    var x = event.clientX - rect.left;
                    var y = event.clientY - rect.top;

                    var clickedX = event.pageX - this.offsetLeft;
                    var clickedY = event.pageY - this.offsetTop;


                    for (var i = 0; i < circles.length; i++) {
                        if (clickedX < circles[i].right && clickedX > circles[i].left && clickedY > circles[i].top && clickedY < circles[i].bottom) {
                           console.log("Player wants to move to city " + (i+1) + " at x: " + x + " y: " + y);
                        }
                    }
                });
            };    
            
            
            function helpText(form){
                form.inputbox.value = 'eg: Tokyo = "9".';
            }
            
            
            var draw = function (context, x, y, fillcolor, radius, linewidth, strokestyle, fontcolor, textalign, fonttype, filltext) {
                context.beginPath();
                context.arc(x, y, radius, 0, 2 * Math.PI, false);
                context.fillStyle = fillcolor;
                context.fill();
                context.lineWidth = linewidth;
                context.strokeStyle = strokestyle;
                context.stroke();

                context.fillStyle = fontcolor;
                context.textAlign = textalign;
                context.font = fonttype;

                context.fillText(filltext, x, y);    
            };
            
            var drawCircle = function (context, x, y, fillcolor, radius, linewidth, strokestyle, fontcolor, textalign, fonttype, filltext, circles) {
                draw(context, x, y, fillcolor, radius, linewidth, strokestyle, fontcolor, textalign, fonttype, filltext);
                var circle = new Circle(x, y, radius);
                circles.push(circle);  
            };
            
            var Circle = function(x,y,radius){
                this.left = x-radius;
                this.top = y-radius;
                this.right = x+radius;
                this.bottom = y+radius;
            };
            
            function readText(form){
                var city = form.inputbox.value;
                var canvas,context;
                canvas = document.getElementById('myCanvas');
                context = canvas.getContext('2d');

                drawCircle(context, canvas.width / 2, canvas.height / 2, "green", 6, 3, "#003300", "black", "center", "bold 26px Arial", "P1", circles);
                
                canvas.addEventListener('click', function(e){
                var clickedX = e.pageX - this.offsetLeft;
                var clickedY = e.pageY - this.offsetTop;
                var rect = canvas.getBoundingClientRect();
                var x = event.clientX - rect.left;
                var y = event.clientY - rect.top;

                for (var i = 0; i < circles.length; i++) {
                    if (clickedX < circles[i].right && clickedX > circles[i].left && clickedY > circles[i].top && clickedY < circles[i].bottom) {
                       console.log("Player " + (i+1) + " wants to move to x: " + x + " y: " + y);
                    }
                }
            });  
        };
            
            function createCities(){
                var canvas,context;
                canvas = document.getElementById('myCanvas');
                context = canvas.getContext('2d')
                drawCircle(context, 126.5, 83, "red", 3, 2, "#003300", "black", "center", "16px Arial", "1", circles);
                drawCircle(context, 139, 85, "red", 3, 2, "#003300", "black", "center", "16px Arial", "2", circles);
                drawCircle(context, 199.5, 75, "red", 3, 2, "#003300", "black", "center", "16px Arial", "3", circles);
                drawCircle(context, 238.5, 190, "red", 3, 2, "#003300", "black", "center", "16px Arial", "4", circles);
                drawCircle(context, 307.5, 55, "red", 3, 2, "#003300", "black", "center", "16px Arial", "5", circles);
                drawCircle(context, 354.5, 199, "red", 3, 2, "#003300", "black", "center", "16px Arial", "6", circles);
                drawCircle(context, 361.5, 45, "red", 3, 2, "#003300", "black", "center", "16px Arial", "7", circles);
                drawCircle(context, 490.5, 106, "red", 3, 2, "#003300", "black", "center", "16px Arial", "8", circles);
                drawCircle(context, 520.5, 84, "red", 3, 2, "#003300", "black", "center", "16px Arial", "9", circles);
                drawCircle(context, 541.5, 207, "red", 3, 2, "#003300", "black", "center", "16px Arial", "10", circles);
                
            }
        
        $(document).ready(function(){
            $("#send").click(function(){
                var dummyJson="{pandemic:game}"
                $.ajax({
                     /* url:"http://localhost:8080", */
                     type: "POST",
                     data: dummyJson,
                     dataType: "json",
                     contentType: "application/json",

                     success: function (data) {
                         var data = JSON.parse(json);

                         //then read json as needed
                        }
                });

            });
        });
		
</script>  
    </head>
        <div class="cityList">
            <p>
                1: Los Angeles <br>
                2: Arizona <br>
                3: New York <br>
                4: Rio De Janeiro <br>
                5: London <br>
                6: Johannesburg <br>
                7: Moscow <br>
                8: Hong Kong <br>
                9: Tokyo <br>
                10: Sydney<br>
            </p>
        </div>
        <div>
            <h1>Welcome to Pandemic!</h1>
            <form name="citySelector" action="" method="POST">
                Enter the id of the city you wish to travel to: <br>
                <input type="text" name="inputbox" value="">
                <input type="button" name="b1" value="Submit" onClick="readText(this.form)">
                <input type="button" id="send" value="SendAjax">
                <input type="button" name="b2" value="Help?" onClick="helpText(this.form)">
            </form>
        </div>
        <canvas id="myCanvas" width="600" height="298" onclick="updateBoard()">
            Your browser does not support canvas.
            <script> createCities(); </script>
        </canvas>
</html>